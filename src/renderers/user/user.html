<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>hanshot</title>
</head>
<body>

  <button data-desktop>Desktop</button>
  <button data-selection>Selection</button>
  <button data-load-windows>Load windows</button>
  <select data-windows></select>

  <hr>

  <button data-upload-imgur>Upload Imgur</button>


  <script type="text/javascript">

    'use strict';

    const electron = require('electron');

    const ipcRenderer = electron.ipcRenderer;

    var btnDesktop = document.querySelector('[data-desktop]');
    var btnSelection = document.querySelector('[data-selection]');
    var btnLoadWindows = document.querySelector('[data-load-windows]');
    var selectWindows = document.querySelector('[data-windows]');

    var btnUploadImgur = document.querySelector('[data-upload-imgur]');

    btnDesktop.addEventListener('click', function () {
      ipcRenderer.send('snapshot-initiated', {
        type: 'desktop'
      });
    }, false);

    btnSelection.addEventListener('click', function () {
      ipcRenderer.send('snapshot-initiated', {
        type: 'selection'
      });
    }, false);

    btnLoadWindows.addEventListener('click', function () {
      empty(selectWindows);

      var option = document.createElement('option');
      option.appendChild(document.createTextNode('Loading...'));
      selectWindows.appendChild(option);

      ipcRenderer.send('load-windows-initiated');
    }, false);

    selectWindows.addEventListener('change', function () {

      var windowId = selectWindows.options[selectWindows.selectedIndex].value;

      ipcRenderer.send('snapshot-initiated', {
        type: 'window',
        windowId: windowId
      });
    }, false);

    btnUploadImgur.addEventListener('click', function () {

      ipcRenderer.send('snapshot-upload', {
        resource: 'imgur'
      });

    }, false);

    ipcRenderer.on('windows-loaded', function (event, windows) {

      empty(selectWindows);

      windows.forEach(function (wind) {
        var option = document.createElement('option');
        option.appendChild(document.createTextNode(wind.name));
        option.value = wind.id;
        selectWindows.appendChild(option);
      });

    });

    function empty(el) {
      while (el.childNodes[0]) {
        el.removeChild(el.childNodes[0]);
      }
    }

  </script>
</body>
</html>